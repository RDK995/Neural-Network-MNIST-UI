<svg xmlns="http://www.w3.org/2000/svg" width="1600" height="520" viewBox="0 0 1600 520" role="img" aria-labelledby="title desc">
  <title id="title">Inference Flow</title>
  <desc id="desc">Raw drawing to preprocessing, layer inference, probabilities, and prediction output.</desc>
  <defs>
    <linearGradient id="bg" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#f8fafc"/><stop offset="100%" stop-color="#eef2ff"/></linearGradient>
    <marker id="arr" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="8" markerHeight="8" orient="auto"><path d="M0 0 L10 5 L0 10 z" fill="#334155"/></marker>
    <style>.t{font:700 30px Helvetica,Arial,sans-serif;fill:#0f172a}.s{font:500 15px Helvetica,Arial,sans-serif;fill:#334155}.b{fill:#fff;stroke:#cbd5e1;stroke-width:1.4;rx:12}.l{font:700 16px Helvetica,Arial,sans-serif;fill:#0f172a}.n{font:500 13px Helvetica,Arial,sans-serif;fill:#475569}.e{stroke:#334155;stroke-width:2.2;fill:none;marker-end:url(#arr)}</style>
  </defs>
  <rect x="0" y="0" width="1600" height="520" fill="url(#bg)"/>
  <text x="32" y="50" class="t">Interactive Inference Flow</text>
  <text x="32" y="76" class="s">What happens when you click “Run Drawn Digit”.</text>

  <rect class="b" x="40" y="130" width="240" height="280"/>
  <text x="60" y="165" class="l">1) Raw Draw Input</text>
  <text x="60" y="190" class="n">User strokes on 28x28 grid</text>
  <rect x="88" y="220" width="150" height="150" fill="#111827" stroke="#64748b"/>
  <path d="M120 348 L133 300 L148 316 L162 265 L176 346" fill="none" stroke="#f1f5f9" stroke-width="9" stroke-linecap="round"/>

  <rect class="b" x="330" y="130" width="280" height="280"/>
  <text x="350" y="165" class="l">2) Preprocessing</text>
  <text x="350" y="190" class="n">crop -> resize -> center -> normalize</text>
  <text x="350" y="220" class="n">Produces model-ready 784 vector</text>
  <rect x="410" y="250" width="120" height="120" fill="#111827" stroke="#64748b"/>
  <path d="M436 348 L447 310 L460 322 L473 278 L488 346" fill="none" stroke="#f8fafc" stroke-width="7" stroke-linecap="round"/>

  <rect class="b" x="660" y="130" width="320" height="280"/>
  <text x="680" y="165" class="l">3) Neural Network Forward Pass</text>
  <text x="680" y="190" class="n">Input(784) -> Dense(128) -> Dropout -> Dense(64) -> Softmax(10)</text>
  <line x1="730" y1="300" x2="910" y2="300" stroke="#94a3b8" stroke-width="2"/>
  <circle cx="730" cy="300" r="8" fill="#2563eb"/><circle cx="790" cy="300" r="8" fill="#059669"/><circle cx="850" cy="300" r="8" fill="#7c3aed"/><circle cx="910" cy="300" r="8" fill="#dc2626"/>

  <rect class="b" x="1030" y="130" width="250" height="280"/>
  <text x="1050" y="165" class="l">4) Probabilities</text>
  <text x="1050" y="190" class="n">Softmax scores for 0..9</text>
  <rect x="1060" y="230" width="200" height="18" fill="#e2e8f0"/><rect x="1060" y="230" width="142" height="18" fill="#16a34a"/>
  <rect x="1060" y="258" width="200" height="18" fill="#e2e8f0"/><rect x="1060" y="258" width="45" height="18" fill="#64748b"/>
  <rect x="1060" y="286" width="200" height="18" fill="#e2e8f0"/><rect x="1060" y="286" width="28" height="18" fill="#64748b"/>

  <rect class="b" x="1330" y="130" width="230" height="280"/>
  <text x="1350" y="165" class="l">5) Final Decision</text>
  <text x="1350" y="190" class="n">argmax(probabilities)</text>
  <text x="1350" y="240" style="font:700 46px Helvetica,Arial,sans-serif;fill:#16a34a">Digit: 7</text>
  <text x="1350" y="276" class="n">Confidence: 71.2%</text>

  <path class="e" d="M280 270 L330 270"/><path class="e" d="M610 270 L660 270"/><path class="e" d="M980 270 L1030 270"/><path class="e" d="M1280 270 L1330 270"/>
</svg>
